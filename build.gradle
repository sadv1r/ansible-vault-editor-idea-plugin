plugins {
    id 'org.jetbrains.intellij' version '0.4.20'
    id 'java'
    id 'org.jetbrains.kotlin.jvm' version '1.3.72'
}

group 'ru.sadv1r'
version '1.3'

repositories {
    mavenCentral()
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
    compile 'bouncycastle:bcprov-jdk16:136'
    compile('de.rtner:PBKDF2:1.1.0') {
        exclude group: 'org.picketbox', module: 'picketbox'
        exclude group: 'org.jboss.logging', module: 'jboss-logging'
    }
}

// See https://github.com/JetBrains/gradle-intellij-plugin/
intellij {
    version '2019.3'
    pluginName 'Ansible Vault Editor'
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

patchPluginXml {
    sinceBuild 193.1
    untilBuild "201.*"

    pluginDescription """
Helps you create and edit Ansible Vaults
<br/>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin">GitHub</a> |
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/issues">Issues</a>
<br/>
<br/>
<b>Features</b>
<ul>
    <li>Create vault in empty file</li>
    <li>Edit existing vault with auto encryption and decryption</li>
    <li>Decrypted yml files syntax highlight</li>
    <li>Remember vault <a href="https://www.jetbrains.com/help/idea/reference-ide-settings-password-safe.html">password</a></li>
</ul>
"""

    changeNotes """
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.3"><b>v1.3</b></a> (2020-05-19)
<br/>
<ul>
    <li>Fixed critical bug with invalid padding bytes</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.2"><b>v1.2</b></a> (2020-05-14)
<br/>
<ul>
    <li>Possibility to remember vault <a href="https://www.jetbrains.com/help/idea/reference-ide-settings-password-safe.html">password</a></li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.1"><b>v1.1</b></a> (2020-05-10)
<br/>
<ul>
    <li>New logo</li>
    <li>Better action name</li>
    <li>Possibility to create new vault from empty file</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.0"><b>v1.0</b></a> (2020-05-10)
<br/>
<ul>
    <li>Initial release of the plugin</li>
    <li>Basic editor for encrypted YML files</li>
</ul>
"""
}