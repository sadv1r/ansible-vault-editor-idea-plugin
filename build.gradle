plugins {
    id 'java'
    id 'org.jetbrains.intellij' version '1.1.4'
    id 'org.jetbrains.kotlin.jvm' version '1.5.21'
}

group 'ru.sadv1r'
version '1.15'

repositories {
    mavenCentral()
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
    implementation('de.rtner:PBKDF2:1.1.4') {
        exclude group: 'org.picketbox', module: 'picketbox'
    }

    testImplementation "org.jetbrains.kotlin:kotlin-test"
    testImplementation 'org.jetbrains.kotlin:kotlin-test-testng'
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
test {
    useJUnit()
}
task integrationTest(type: Test) {
    useTestNG()
}

// See https://github.com/JetBrains/gradle-intellij-plugin/
intellij {
    plugins = ['yaml']
    version = '2020.2'
    pluginName = 'Ansible Vault Editor'
}

patchPluginXml {
    sinceBuild = "191.1"
    untilBuild = "212.*"

    pluginDescription = """
Helps you create and edit Ansible Vaults
<br/>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin">GitHub</a> |
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/issues">Issues</a>
<br/>
<br/>
<b>Features</b>
<ul>
    <li>Encrypt <a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#encrypting-files-with-ansible-vault">file as Ansible Vault</a></li>
    <li>Encrypt <a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#encrypting-individual-variables-with-ansible-vault">individual YAML property</a></li>
    <li>Modify existing Vault with auto encryption/decryption and protection from accidental pushing of sensitive data</li>
    <li>Remember each vault <a href="https://www.jetbrains.com/help/idea/reference-ide-settings-password-safe.html">password</a> or use <a href ="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_VAULT_PASSWORD_FILE">ANSIBLE_VAULT_PASSWORD_FILE</a> variable</li>
    <li>Re-encrypt vault with new password</li>
</ul>
"""

    changeNotes = """
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.15"><b>v1.15</b></a> (2021-07-12)
<br/>
<ul>
    <li>IntelliJ Platform 2021.2 support</li>
    <li><a href ="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_VAULT_PASSWORD_FILE">ANSIBLE_VAULT_PASSWORD_FILE</a> environment variable support</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.14"><b>v1.14</b></a> (2021-06-01)
<br/>
<ul>
    <li>Possibility to encrypt any existing file</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.13"><b>v1.13</b></a> (2021-05-25)
<br/>
<ul>
    <li>Possibility to encrypt existing yaml value</li>
    <li>Vault <a href="https://www.jetbrains.com/help/idea/settings-gutter-icons.html">gutter</a> icons added with modify action on click</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.12"><b>v1.12</b></a> (2021-05-13)
<br/>
<ul>
    <li>Possibility to change Vault password</li>
    <li>Intentions family names changed to add possibility to disable them separately</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.11"><b>v1.11</b></a> (2021-02-03)
<br/>
<ul>
    <li>Using Bouncy Castle bundled with IntelliJ</li>
    <li>IntelliJ Platform 2021.1 support</li>
    <li>Reduced plugin size</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.9"><b>v1.9</b></a> (2021-01-11)
<br/>
<ul>
    <li>Fixed error on empty file vault creation</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.8"><b>v1.8</b></a> (2020-12-03)
<br/>
<ul>
    <li>IntelliJ Platform 2020.3 support</li>
    <li>Fixed null vault id labels when not set</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.7"><b>v1.7</b></a> (2020-11-18)
<br/>
<ul>
    <li>Support for Vault ID labels</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.6"><b>v1.6</b></a> (2020-08-08)
<br/>
<ul>
    <li>Encrypted <a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#encrypt-string-for-use-in-yaml">YAML properties</a> modification</li>
    <li>Decrypted editor syntax highlighting for all languages supported by IDE</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.5"><b>v1.5</b></a> (2020-07-13)
<br/>
<ul>
    <li>Support from older than ever IntelliJ 2019.1 to new 2020.2</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.4"><b>v1.4</b></a> (2020-06-06)
<br/>
<ul>
    <li>Decrypt by Alt+Enter</li>
    <li>Cleaning password field if wrong for faster correction</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.3"><b>v1.3</b></a> (2020-05-19)
<br/>
<ul>
    <li>Fixed critical bug with invalid padding bytes</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.2"><b>v1.2</b></a> (2020-05-14)
<br/>
<ul>
    <li>Possibility to remember vault <a href="https://www.jetbrains.com/help/idea/reference-ide-settings-password-safe.html">password</a></li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.1"><b>v1.1</b></a> (2020-05-10)
<br/>
<ul>
    <li>New logo</li>
    <li>Better action name</li>
    <li>Possibility to create new vault from empty file</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.0"><b>v1.0</b></a> (2020-05-10)
<br/>
<ul>
    <li>Initial release of the plugin</li>
    <li>Basic editor for encrypted YML files</li>
</ul>
"""
}
