plugins {
    id 'org.jetbrains.intellij' version '0.4.21'
    id 'java'
    id 'org.jetbrains.kotlin.jvm' version '1.3.72'
}

group 'ru.sadv1r'
version '1.7'

repositories {
    mavenCentral()
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
    compile 'bouncycastle:bcprov-jdk16:136'
    compile('de.rtner:PBKDF2:1.1.0') {
        exclude group: 'org.picketbox', module: 'picketbox'
        exclude group: 'org.jboss.logging', module: 'jboss-logging'
    }

    testImplementation "org.jetbrains.kotlin:kotlin-test"
    testImplementation 'org.jetbrains.kotlin:kotlin-test-testng'
}

// See https://github.com/JetBrains/gradle-intellij-plugin/
intellij {
    plugins = ['yaml']
    version '2020.1'
    pluginName 'Ansible Vault Editor'
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
test {
    useJUnit()
}

task integrationTest(type: Test) {
    useTestNG()
}

patchPluginXml {
    sinceBuild 191.1
    untilBuild "202.*"

    pluginDescription """
Helps you create and edit Ansible Vaults
<br/>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin">GitHub</a> |
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/issues">Issues</a>
<br/>
<br/>
<b>Features</b>
<ul>
    <li>Create vault in empty file</li>
    <li>Edit existing vault with auto encryption and decryption</li>
    <li>Encrypted <a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#encrypt-string-for-use-in-yaml">YAML properties</a> modification</li>
    <li>Decrypted yml files syntax highlight</li>
    <li>Remember vault <a href="https://www.jetbrains.com/help/idea/reference-ide-settings-password-safe.html">password</a></li>
</ul>
"""

    changeNotes """
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.7"><b>v1.7</b></a> (2020-11-18)
<br/>
<ul>
    <li>Support for Vault ID labels</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.6"><b>v1.6</b></a> (2020-08-08)
<br/>
<ul>
    <li>Encrypted <a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#encrypt-string-for-use-in-yaml">YAML properties</a> modification</li>
    <li>Decrypted editor syntax highlighting for all languages supported by IDE</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.5"><b>v1.5</b></a> (2020-07-13)
<br/>
<ul>
    <li>Support from older than ever IntelliJ 2019.1 to new 2020.2</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.4"><b>v1.4</b></a> (2020-06-06)
<br/>
<ul>
    <li>Decrypt by Alt+Enter</li>
    <li>Cleaning password field if wrong for faster correction</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.3"><b>v1.3</b></a> (2020-05-19)
<br/>
<ul>
    <li>Fixed critical bug with invalid padding bytes</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.2"><b>v1.2</b></a> (2020-05-14)
<br/>
<ul>
    <li>Possibility to remember vault <a href="https://www.jetbrains.com/help/idea/reference-ide-settings-password-safe.html">password</a></li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.1"><b>v1.1</b></a> (2020-05-10)
<br/>
<ul>
    <li>New logo</li>
    <li>Better action name</li>
    <li>Possibility to create new vault from empty file</li>
</ul>
<br/>
<a href="https://github.com/sadv1r/ansible-vault-editor-idea-plugin/tree/v1.0"><b>v1.0</b></a> (2020-05-10)
<br/>
<ul>
    <li>Initial release of the plugin</li>
    <li>Basic editor for encrypted YML files</li>
</ul>
"""
}
